/*! 
 Build based on gin-vue-admin 
 Time : 1675228064000 */
import{g as e,d as l,a,u as t,c as u,b as o}from"./api.1ae2056e.js";import{t as i}from"./stringFun.1a90c7e7.js";import{W as s}from"./warningBar.05f9d88c.js";import{_ as d,r as p,b as r,o as n,c as m,d as c,e as v,w as f,F as g,x as b,m as h,h as y,t as _,i as V,A as w,q as k,v as C}from"./index.6ee4fc76.js";const z={class:"gva-search-box"},x={class:"gva-table-box"},A={class:"gva-btn-list"},U=(e=>(k("data-v-1b9468b2"),e=e(),C(),e))((()=>c("p",null,"确定要删除吗？",-1))),G={style:{"text-align":"right","margin-top":"8px"}},I={class:"gva-pagination"},P={class:"dialog-footer"},j={name:"Api"},S=d(Object.assign(j,{setup(d){const k=e=>{const l=S.value.filter((l=>l.value===e))[0];return l&&`${l.label}`},C=p([]),j=p({path:"",apiGroup:"",method:"",description:""}),S=p([{value:"POST",label:"创建",type:"success"},{value:"GET",label:"查看",type:""},{value:"PUT",label:"更新",type:"warning"},{value:"DELETE",label:"删除",type:"danger"}]),T=p(""),q=p({path:[{required:!0,message:"请输入api路径",trigger:"blur"}],apiGroup:[{required:!0,message:"请输入组名称",trigger:"blur"}],method:[{required:!0,message:"请选择请求方式",trigger:"blur"}],description:[{required:!0,message:"请输入api介绍",trigger:"blur"}]}),D=p(1),F=p(0),$=p(10),E=p([]),B=p({}),O=()=>{B.value={}},K=()=>{D.value=1,$.value=10,J()},L=e=>{$.value=e,J()},W=e=>{D.value=e,J()},H=({prop:e,order:l})=>{e&&("ID"===e&&(e="id"),B.value.orderKey=i(e),B.value.desc="descending"===l),J()},J=async()=>{const l=await e({page:D.value,pageSize:$.value,...B.value});0===l.code&&(E.value=l.data.list,F.value=l.data.total,D.value=l.data.page,$.value=l.data.pageSize)};J();const M=e=>{C.value=e},N=p(!1),Q=async()=>{const e=C.value.map((e=>e.ID)),a=await l({ids:e});0===a.code&&(V({type:"success",message:a.msg}),E.value.length===e.length&&D.value>1&&D.value--,N.value=!1,J())},R=p(null),X=p("新增Api"),Y=p(!1),Z=e=>{switch(e){case"addApi":X.value="新增Api";break;case"edit":X.value="编辑Api"}T.value=e,Y.value=!0},ee=()=>{R.value.resetFields(),j.value={path:"",apiGroup:"",method:"",description:""},Y.value=!1},le=async()=>{R.value.validate((async e=>{if(e)switch(T.value){case"addApi":0===(await u(j.value)).code&&V({type:"success",message:"添加成功",showClose:!0}),J(),ee();break;case"edit":0===(await t(j.value)).code&&V({type:"success",message:"编辑成功",showClose:!0}),J(),ee();break;default:V({type:"error",message:"未知操作",showClose:!0})}}))};return(e,l)=>{const t=r("el-input"),u=r("el-form-item"),i=r("el-option"),d=r("el-select"),p=r("el-button"),T=r("el-form"),ae=r("el-popover"),te=r("el-table-column"),ue=r("el-table"),oe=r("el-pagination"),ie=r("el-dialog");return n(),m("div",null,[c("div",z,[v(T,{ref:"searchForm",inline:!0,model:B.value},{default:f((()=>[v(u,{label:"路径"},{default:f((()=>[v(t,{modelValue:B.value.path,"onUpdate:modelValue":l[0]||(l[0]=e=>B.value.path=e),placeholder:"路径"},null,8,["modelValue"])])),_:1}),v(u,{label:"描述"},{default:f((()=>[v(t,{modelValue:B.value.description,"onUpdate:modelValue":l[1]||(l[1]=e=>B.value.description=e),placeholder:"描述"},null,8,["modelValue"])])),_:1}),v(u,{label:"API组"},{default:f((()=>[v(t,{modelValue:B.value.apiGroup,"onUpdate:modelValue":l[2]||(l[2]=e=>B.value.apiGroup=e),placeholder:"api组"},null,8,["modelValue"])])),_:1}),v(u,{label:"请求"},{default:f((()=>[v(d,{modelValue:B.value.method,"onUpdate:modelValue":l[3]||(l[3]=e=>B.value.method=e),clearable:"",placeholder:"请选择"},{default:f((()=>[(n(!0),m(g,null,b(S.value,(e=>(n(),h(i,{key:e.value,label:`${e.label}(${e.value})`,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),v(u,null,{default:f((()=>[v(p,{size:"small",type:"primary",icon:"search",onClick:K},{default:f((()=>[y("查询")])),_:1}),v(p,{size:"small",icon:"refresh",onClick:O},{default:f((()=>[y("重置")])),_:1})])),_:1})])),_:1},8,["model"])]),c("div",x,[c("div",A,[v(p,{size:"small",type:"primary",icon:"plus",onClick:l[4]||(l[4]=e=>Z("addApi"))},{default:f((()=>[y("新增")])),_:1}),v(ae,{modelValue:N.value,"onUpdate:modelValue":l[7]||(l[7]=e=>N.value=e),placement:"top",width:"160"},{reference:f((()=>[v(p,{icon:"delete",size:"small",disabled:!C.value.length,style:{"margin-left":"10px"},onClick:l[6]||(l[6]=e=>N.value=!0)},{default:f((()=>[y("删除")])),_:1},8,["disabled"])])),default:f((()=>[U,c("div",G,[v(p,{size:"small",type:"primary",link:"",onClick:l[5]||(l[5]=e=>N.value=!1)},{default:f((()=>[y("取消")])),_:1}),v(p,{size:"small",type:"primary",onClick:Q},{default:f((()=>[y("确定")])),_:1})])])),_:1},8,["modelValue"])]),v(ue,{data:E.value,onSortChange:H,onSelectionChange:M},{default:f((()=>[v(te,{type:"selection",width:"55"}),v(te,{align:"left",label:"id","min-width":"60",prop:"ID",sortable:"custom"}),v(te,{align:"left",label:"API路径","min-width":"150",prop:"path",sortable:"custom"}),v(te,{align:"left",label:"API分组","min-width":"150",prop:"apiGroup",sortable:"custom"}),v(te,{align:"left",label:"API简介","min-width":"150",prop:"description",sortable:"custom"}),v(te,{align:"left",label:"请求","min-width":"150",prop:"method",sortable:"custom"},{default:f((e=>[c("div",null,_(e.row.method)+" / "+_(k(e.row.method)),1)])),_:1}),v(te,{align:"left",fixed:"right",label:"操作",width:"200"},{default:f((e=>[v(p,{icon:"edit",size:"small",type:"primary",link:"",onClick:l=>(async e=>{const l=await a({id:e.ID});j.value=l.data.api,Z("edit")})(e.row)},{default:f((()=>[y("编辑")])),_:2},1032,["onClick"]),v(p,{icon:"delete",size:"small",type:"primary",link:"",onClick:l=>(async e=>{w.confirm("此操作将永久删除所有角色下该api, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await o(e)).code&&(V({type:"success",message:"删除成功!"}),1===E.value.length&&D.value>1&&D.value--,J())}))})(e.row)},{default:f((()=>[y("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),c("div",I,[v(oe,{"current-page":D.value,"page-size":$.value,"page-sizes":[10,30,50,100],total:F.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:W,onSizeChange:L},null,8,["current-page","page-size","total"])])]),v(ie,{modelValue:Y.value,"onUpdate:modelValue":l[12]||(l[12]=e=>Y.value=e),"before-close":ee,title:X.value},{footer:f((()=>[c("div",P,[v(p,{size:"small",onClick:ee},{default:f((()=>[y("取 消")])),_:1}),v(p,{size:"small",type:"primary",onClick:le},{default:f((()=>[y("确 定")])),_:1})])])),default:f((()=>[v(s,{title:"新增API，需要在角色管理内配置权限才可使用"}),v(T,{ref_key:"apiForm",ref:R,model:j.value,rules:q.value,"label-width":"80px"},{default:f((()=>[v(u,{label:"路径",prop:"path"},{default:f((()=>[v(t,{modelValue:j.value.path,"onUpdate:modelValue":l[8]||(l[8]=e=>j.value.path=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),v(u,{label:"请求",prop:"method"},{default:f((()=>[v(d,{modelValue:j.value.method,"onUpdate:modelValue":l[9]||(l[9]=e=>j.value.method=e),placeholder:"请选择",style:{width:"100%"}},{default:f((()=>[(n(!0),m(g,null,b(S.value,(e=>(n(),h(i,{key:e.value,label:`${e.label}(${e.value})`,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),v(u,{label:"api分组",prop:"apiGroup"},{default:f((()=>[v(t,{modelValue:j.value.apiGroup,"onUpdate:modelValue":l[10]||(l[10]=e=>j.value.apiGroup=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),v(u,{label:"api简介",prop:"description"},{default:f((()=>[v(t,{modelValue:j.value.description,"onUpdate:modelValue":l[11]||(l[11]=e=>j.value.description=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-1b9468b2"]]);export{S as default};

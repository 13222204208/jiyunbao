/*! 
 Build based on gin-vue-admin 
 Time : 1673519692000 */
import{g as e,d as a,f as l,a as t,c as o,u as n}from"./appAgreement.b3eeeca9.js";import{f as i,a as s,g as r}from"./format.9730cff4.js";import{a as u,J as d,L as c,M as p,N as m,O as v,o as f,c as g,d as b,z as y,t as h,f as _,F as w,r as k,b as C,e as V,w as j,h as z,x as O,m as x,A as D,i as A}from"./index.29e958a1.js";import"./date.34b11046.js";import"./dictionary.756c2897.js";import"./dictionary.90e3faa4.js";import"./sysDictionary.77e8fb14.js";var S=Object.defineProperty,T=Object.defineProperties,E=Object.getOwnPropertyDescriptors,I=Object.getOwnPropertySymbols,P=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable,U=(e,a,l)=>a in e?S(e,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[a]=l;const H=e=>e+"_"+(Date.now()+Math.floor(1e6*Math.random())),q=()=>{const e="undefined"!=typeof window?window:global;return e&&"tinymce"in e?e.tinymce:null};function F(e){return e?e.getContent():""}function M(e,a){a&&a.setContent(e)}function N(e,a=!0){e&&e.mode.set(a?"readonly":"design")}function B(e,a,l,t,o){let n,i,{images_upload_url:s,images_upload_credentials:r,custom_images_upload_header:u,custom_images_upload_param:d,custom_images_upload_callback:c}=e||{};n=new XMLHttpRequest,n.withCredentials=!!r,n.open("POST",s||""),u&&Object.keys(u).forEach((e=>{n.setRequestHeader(e,u[e])})),n.upload.onprogress=function(e){o(e.loaded/e.total*100)},n.onload=function(){if(403===n.status)return void t("HTTP Error (custom): status "+n.status,{remove:!0});if(n.status<200||n.status>=300)return void t("HTTP Error (custom): status "+n.status);let e=JSON.parse(n.responseText);if(!e)return void t("Invalid JSON (custom): "+n.responseText);let a="function"==typeof c?c(e):e.location;a?l(a):t("Failed Path (custom): location image path is error/empty")},n.onerror=function(){t("Image upload failed due to a XHR Transport error. Code: "+n.status)},i=new FormData,i.append("file",a.blob(),a.filename()),d&&Object.keys(d).forEach((e=>{i.append(e,d[e])})),n.send(i)}const R=(()=>{let e={status:{},loadedCallbacks:{}};const a=a=>{e.loadedCallbacks[a]&&(e.loadedCallbacks[a].forEach((e=>{"function"==typeof e.handler&&e.handler.call(e.scope)})),e.loadedCallbacks[a]=void 0)};return{load:(l,t,o)=>{t&&(e.loadedCallbacks[l]||(e.loadedCallbacks[l]=[]),e.loadedCallbacks[l].push({handler:t,scope:o||void 0})),"LOADED"!==e.status[l]?"LOADING"!==e.status[l]&&(e.status[l]="LOADING",((t,o)=>{const n=document.createElement("script");n.id=H("tiny-script"),n.type="application/javascript",n.src=t,n.referrerPolicy="origin";const i=()=>{n.removeEventListener("load",i),e.status[l]="LOADED",a(l)};n.addEventListener("load",i),(document.head||document.body).appendChild(n)})(l)):a(l)}}})(),J=["id"],$={key:0},G=Object.assign({name:"Vue3Tinymce"},{props:{modelValue:String,setting:{type:Object,default:()=>({})},setup:Function,disabled:Boolean,scriptSrc:String,debug:Boolean},emits:["update:modelValue","init","change"],setup:function(e,{expose:a,emit:l}){const t=e;let o=!0;const n=u({editor:null,id:H("tinymce"),err:""}),i=()=>{var e;return String(null!=(e=t.modelValue)?e:"")},s=(e,a,l)=>{t.debug&&console.log(`来自：${e.type} | \n ${a} \n ${l||"--"}`)},r=()=>{if(null===q())return void(n.err="tinymce is null");t.debug&&console.warn("vue3-tinymce 进入debug模式");let e=(a=((e,a)=>{for(var l in a||(a={}))P.call(a,l)&&U(e,l,a[l]);if(I)for(var l of I(a))L.call(a,l)&&U(e,l,a[l]);return e})({},t.setting),r={selector:"#"+n.id,setup:e=>{t.setup&&t.setup(e),e.on("init",(()=>{return a=e,n.editor=a,M(i(),a),t.disabled&&"readonly"!==a.mode.get()&&N(a),a.on("change input undo redo",(e=>{((e,a)=>{a||(a=n.editor);const t=F(a);s(e,t),l("update:modelValue",t),l("change",t)})(e,a)})),void l("init",a);var a}))}},T(a,E(r)));var a,r;t.setting.custom_images_upload&&(e.images_upload_handler=(...e)=>{B.apply(null,[t.setting||{},...e])}),q().init(e),o=!1};return d((()=>t.modelValue),((e,a)=>{if(n.editor&&n.editor.initialized&&a!==e&&e!==F(n.editor)){if(s({type:"propsChanged to setContent"},e,a),null===e)return function(e,a){if(a){if(a.resetContent)return a.resetContent("");a.setContent(""),a.setDirty(!1),a.undoManager.clear()}}(0,n.editor);M(i(),n.editor)}})),d((()=>t.disabled),(e=>{n.editor&&n.editor.initialized&&N(n.editor,e)})),a({id:n.id,editor:n.editor}),c((()=>{var e;if(null!==q())return void r();const a=null!=(e=t.scriptSrc)?e:"https://cdn.bootcdn.net/ajax/libs/tinymce/5.8.2/tinymce.min.js";R.load(a,r)})),p((()=>{o||r()})),m((()=>{n.editor&&n.editor.remove()})),v((()=>{n.editor&&n.editor.remove()})),(e,a)=>(f(),g(w,null,[b("div",{id:y(n).id,class:"tiny-textarea"},null,8,J),y(n).err?(f(),g("p",$,h(y(n).err),1)):_("",!0)],64))}});G.install=function(e){e.component("Vue3Tinymce",G)};const X={class:"gva-search-box"},K={class:"gva-table-box"},Q={class:"gva-btn-list"},W=b("p",null,"确定要删除吗？",-1),Y={style:{"text-align":"right","margin-top":"8px"}},Z={class:"gva-pagination"},ee={class:"dialog-footer"},ae={name:"AppAgreement"},le=Object.assign(ae,{setup(d){const c=k({content:"",setting:{toolbar:"undo redo | fullscreen | blocks alignleft aligncenter alignright alignjustify | link unlink | numlist bullist | table | fontsize forecolor backcolor | bold italic underline strikethrough | indent outdent | superscript subscript | removeformat |",toolbar_mode:"sliding",quickbars_selection_toolbar:"removeformat | bold italic underline strikethrough | fontsize forecolor backcolor",plugins:"link image media table lists fullscreen quickbars",font_size_formats:"12px 14px 16px 18px",link_default_target:"_blank",link_title:!1,nonbreaking_force_tab:!0,height:480,language:"zh-Hans",language_url:"https://unpkg.com/@jsdawn/vue3-tinymce@2.0.2/dist/tinymce/langs/zh-Hans.js"}}),p=k([]),m=k({way:void 0,title:"",contents:""}),v=u({way:[{required:!0,message:"",trigger:["input","blur"]}]}),_=k(),S=k(1),T=k(0),E=k(10),I=k([]),P=k({}),L=()=>{P.value={}},U=()=>{S.value=1,E.value=10,F()},H=e=>{E.value=e,F()},q=e=>{S.value=e,F()},F=async()=>{const a=await e({page:S.value,pageSize:E.value,...P.value});0===a.code&&(I.value=a.data.list,T.value=a.data.total,S.value=a.data.page,E.value=a.data.pageSize)};F();(async()=>{p.value=await r("agreement")})();const M=k([]),N=e=>{M.value=e},B=k(!1),R=async()=>{const e=[];if(0===M.value.length)return void A({type:"warning",message:"请选择要删除的数据"});M.value&&M.value.map((a=>{e.push(a.ID)}));0===(await a({ids:e})).code&&(A({type:"success",message:"删除成功"}),I.value.length===e.length&&S.value>1&&S.value--,B.value=!1,F())},J=k(""),$=async e=>{0===(await t({ID:e.ID})).code&&(A({type:"success",message:"删除成功"}),1===I.value.length&&S.value>1&&S.value--,F())},ae=k(!1),le=()=>{J.value="create",ae.value=!0},te=()=>{ae.value=!1,m.value={way:void 0,title:"",contents:""}},oe=async()=>{var e;null==(e=_.value)||e.validate((async e=>{if(!e)return;let a;switch(m.value.contents=c.value.content,J.value){case"create":default:a=await o(m.value);break;case"update":a=await n(m.value)}0===a.code&&(A({type:"success",message:"创建/更改成功"}),te(),F())}))};return(e,a)=>{const t=C("el-date-picker"),o=C("el-form-item"),n=C("el-option"),r=C("el-select"),u=C("el-button"),d=C("el-form"),k=C("el-popover"),A=C("el-table-column"),F=C("el-table"),ne=C("el-pagination"),ie=C("el-input"),se=C("el-dialog");return f(),g("div",null,[b("div",X,[V(d,{inline:!0,model:P.value,class:"demo-form-inline"},{default:j((()=>[V(o,{label:"创建时间"},{default:j((()=>[V(t,{modelValue:P.value.startCreatedAt,"onUpdate:modelValue":a[0]||(a[0]=e=>P.value.startCreatedAt=e),type:"datetime",placeholder:"开始时间"},null,8,["modelValue"]),z(" — "),V(t,{modelValue:P.value.endCreatedAt,"onUpdate:modelValue":a[1]||(a[1]=e=>P.value.endCreatedAt=e),type:"datetime",placeholder:"结束时间"},null,8,["modelValue"])])),_:1}),V(o,{label:"协议类型",prop:"way"},{default:j((()=>[V(r,{modelValue:P.value.way,"onUpdate:modelValue":a[2]||(a[2]=e=>P.value.way=e),clearable:"",placeholder:"请选择",onClear:a[3]||(a[3]=()=>{P.value.way=void 0})},{default:j((()=>[(f(!0),g(w,null,O(p.value,((e,a)=>(f(),x(n,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),V(o,null,{default:j((()=>[V(u,{size:"small",type:"primary",icon:"search",onClick:U},{default:j((()=>[z("查询")])),_:1}),V(u,{size:"small",icon:"refresh",onClick:L},{default:j((()=>[z("重置")])),_:1})])),_:1})])),_:1},8,["model"])]),b("div",K,[b("div",Q,[V(u,{size:"small",type:"primary",icon:"plus",onClick:le},{default:j((()=>[z("新增")])),_:1}),V(k,{visible:B.value,"onUpdate:visible":a[6]||(a[6]=e=>B.value=e),placement:"top",width:"160"},{reference:j((()=>[V(u,{icon:"delete",size:"small",style:{"margin-left":"10px"},disabled:!M.value.length,onClick:a[5]||(a[5]=e=>B.value=!0)},{default:j((()=>[z("删除")])),_:1},8,["disabled"])])),default:j((()=>[W,b("div",Y,[V(u,{size:"small",type:"primary",link:"",onClick:a[4]||(a[4]=e=>B.value=!1)},{default:j((()=>[z("取消")])),_:1}),V(u,{size:"small",type:"primary",onClick:R},{default:j((()=>[z("确定")])),_:1})])])),_:1},8,["visible"])]),V(F,{ref:"multipleTable",style:{width:"100%"},"tooltip-effect":"dark",data:I.value,"row-key":"ID",onSelectionChange:N},{default:j((()=>[V(A,{type:"selection",width:"55"}),V(A,{align:"left",label:"日期",width:"180"},{default:j((e=>[z(h(y(i)(e.row.CreatedAt)),1)])),_:1}),V(A,{align:"left",label:"协议类型",prop:"way",width:"120"},{default:j((e=>[z(h(y(s)(e.row.way,p.value)),1)])),_:1}),V(A,{align:"left",label:"协议标题",prop:"title",width:"120"}),V(A,{align:"left",label:"按钮组"},{default:j((e=>[V(u,{type:"primary",link:"",icon:"edit",size:"small",class:"table-button",onClick:a=>(async e=>{const a=await l({ID:e.ID});J.value="update",0===a.code&&(m.value=a.data.reappAgreement,ae.value=!0)})(e.row)},{default:j((()=>[z("变更")])),_:2},1032,["onClick"]),V(u,{type:"primary",link:"",icon:"delete",size:"small",onClick:a=>{return l=e.row,void D.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{$(l)}));var l}},{default:j((()=>[z("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),b("div",Z,[V(ne,{layout:"total, sizes, prev, pager, next, jumper","current-page":S.value,"page-size":E.value,"page-sizes":[10,30,50,100],total:T.value,onCurrentChange:q,onSizeChange:H},null,8,["current-page","page-size","total"])])]),V(se,{modelValue:ae.value,"onUpdate:modelValue":a[10]||(a[10]=e=>ae.value=e),"before-close":te,title:"弹窗操作"},{footer:j((()=>[b("div",ee,[V(u,{size:"small",onClick:te},{default:j((()=>[z("取 消")])),_:1}),V(u,{size:"small",type:"primary",onClick:oe},{default:j((()=>[z("确 定")])),_:1})])])),default:j((()=>[V(d,{model:m.value,"label-position":"right",ref_key:"elFormRef",ref:_,rules:v,"label-width":"100px"},{default:j((()=>[V(o,{label:"协议类型:",prop:"way"},{default:j((()=>[V(r,{modelValue:m.value.way,"onUpdate:modelValue":a[7]||(a[7]=e=>m.value.way=e),placeholder:"请选择",style:{width:"100%"},clearable:!0},{default:j((()=>[(f(!0),g(w,null,O(p.value,((e,a)=>(f(),x(n,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),V(o,{label:"协议标题:",prop:"title"},{default:j((()=>[V(ie,{modelValue:m.value.title,"onUpdate:modelValue":a[8]||(a[8]=e=>m.value.title=e),clearable:!0,placeholder:"请输入"},null,8,["modelValue"])])),_:1}),V(o,{label:"协议内容:",prop:"contents"},{default:j((()=>[V(y(G),{modelValue:c.value.content,"onUpdate:modelValue":a[9]||(a[9]=e=>c.value.content=e),setting:c.value.setting},null,8,["modelValue","setting"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}});export{le as default};

/*! 
 Build based on gin-vue-admin 
 Time : 1675228064000 */
!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}System.register(["./index-legacy.fe22f6e6.js"],(function(n,a){"use strict";var i,r,o,l,u,d,s,c,f,p,h,m,g=document.createElement("style");return g.textContent=".image-uploader[data-v-9e910477]{border:1px dashed #d9d9d9;width:180px;border-radius:6px;cursor:pointer;position:relative;overflow:hidden}.image-uploader[data-v-9e910477]{border-color:#409eff}.image-uploader-icon[data-v-9e910477]{font-size:28px;color:#8c939d;width:178px;height:178px;line-height:178px;text-align:center}.image[data-v-9e910477]{width:178px;height:178px;display:block}\n",document.head.appendChild(g),{setters:[function(e){i=e.s,r=e._,o=e.r,l=e.j,u=e.b,d=e.o,s=e.c,c=e.e,f=e.w,p=e.h,h=e.z,m=e.i}],execute:function(){n("g",(function(e){return i({url:"/fileUploadAndDownload/getFileList",method:"post",data:e})})),n("d",(function(e){return i({url:"/fileUploadAndDownload/deleteFile",method:"post",data:e})})),n("e",(function(e){return i({url:"/fileUploadAndDownload/editFileName",method:"post",data:e})}));var a=function(){function n(t,a){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1920;e(this,n),this.file=t,this.fileSize=a,this.maxWH=i}var a,i,r;return a=n,(i=[{key:"compress",value:function(){var e=this,t=this.file.type,n=this.file.size/1024;return new Promise((function(a){var i=new FileReader;i.readAsDataURL(e.file),i.onload=function(){var r=document.createElement("canvas"),o=document.createElement("img");o.src=i.result,o.onload=function(){var i=r.getContext("2d"),l=e.dWH(o.width,o.height,e.maxWH);r.width=l.width,r.height=l.height,i.clearRect(0,0,r.width,r.height),i.drawImage(o,0,0,r.width,r.height);var u=r.toDataURL(t,.9),d=e.fileSizeKB(u);d>e.fileSize&&console.log("图片尺寸太大!"+n+" >> "+d);var s=e.dataURLtoBlob(u,t),c=new File([s],e.file.name);a(c)}}}))}},{key:"dWH",value:function(e,t,n){var a={width:e,height:t};return Math.max(e,t)>n?e>t?(a.width=n,a.height=Math.round(t*(n/e)),a):(a.height=n,a.width=Math.round(e*(n/t)),a):a}},{key:"fileSizeKB",value:function(e){return Math.round(3*e.split(",")[1].length/4/1024)}},{key:"dataURLtoBlob",value:function(e,t){for(var n=atob(e.split(",")[1]),a=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(n.length),r=new Uint8Array(i),o=0;o<n.length;o++)r[o]=n.charCodeAt(o);return t&&(a=t),new Blob([i],{type:a,lastModifiedDate:new Date})}}])&&t(a.prototype,i),r&&t(a,r),Object.defineProperty(a,"prototype",{writable:!1}),n}(),g={name:"UploadImage",methods:{}},v=(n("U",r(Object.assign(g,{props:{imageUrl:{type:String,default:""},fileSize:{type:Number,default:2048},maxWH:{type:Number,default:1920}},emits:["on-success"],setup:function(e,t){var n=t.emit,i=e,r=o("/api"),g=l(),v=function(e){var t="image/jpeg"===e.type,n="image/png"===e.type;if(!t&&!n)return m.error("上传头像图片只能是 jpg或png 格式!"),!1;var r=e.size/1024<i.fileSize;return r||new a(e,i.fileSize,i.maxWH).compress()},w=function(e){var t=e.data;t.file&&n("on-success",t.file.url)};return function(e,t){var n=u("el-button"),a=u("el-upload");return d(),s("div",null,[c(a,{action:"".concat(r.value,"/fileUploadAndDownload/upload"),headers:{"x-token":h(g).token},"show-file-list":!1,"on-success":w,"before-upload":v,multiple:!1},{default:f((function(){return[c(n,{size:"small",type:"primary"},{default:f((function(){return[p("压缩上传")]})),_:1})]})),_:1},8,["action","headers"])])}}}),[["__scopeId","data-v-9e910477"]])),{name:"UploadCommon",methods:{}});n("_",Object.assign(v,{emits:["on-success"],setup:function(e,t){var n=t.emit,a=o("/api"),i=l(),r=o(!1),g=function(e){r.value=!0;var t="image/jpeg"===e.type,n="image/png"===e.type,a=e.size/1024/1024<.5;return t||n||(m.error("上传图片只能是 jpg或png 格式!"),r.value=!1),a||(m.error("未压缩未见上传图片大小不能超过 500KB，请使用压缩上传"),r.value=!1),(n||t)&&a},v=function(e){var t=e.data;t.file&&n("on-success",t.file.url)},w=function(){m({type:"error",message:"上传失败"}),r.value=!1};return function(e,t){var n=u("el-button"),r=u("el-upload");return d(),s("div",null,[c(r,{action:"".concat(a.value,"/fileUploadAndDownload/upload"),"before-upload":g,headers:{"x-token":h(i).token},"on-error":w,"on-success":v,"show-file-list":!1,class:"upload-btn"},{default:f((function(){return[c(n,{size:"small",type:"primary"},{default:f((function(){return[p("普通上传")]})),_:1})]})),_:1},8,["action","headers"])])}}}))}}}))}();

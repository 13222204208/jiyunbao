/*! 
 Build based on gin-vue-admin 
 Time : 1673519692000 */
import{_ as e,a as l,r as a,b as t,o,c as u,d,e as i,w as n,h as m,t as p,m as r,p as s,f as v,W as c,A as f,aa as h,i as b,ab as y,ac as w,ad as g,q as V,v as _}from"./index.29e958a1.js";import k from"./icon.0940b8f6.js";import{W as I}from"./warningBar.e39232e5.js";import{c as x}from"./authorityBtn.10105b07.js";const D=e=>(V("data-v-63bcc824"),e=e(),_(),e),U={class:"gva-table-box"},C={class:"gva-btn-list"},z={key:0,class:"icon-column"},B={style:{display:"inline-flex"}},N=D((()=>d("span",{style:{"font-size":"12px","margin-right":"12px"}},"如果菜单包含子菜单，请创建router-view二级路由页面或者",-1))),q=D((()=>d("span",null," 高亮菜单 ",-1))),A={class:"dialog-footer"},T={name:"Menus"},S=e(Object.assign(T,{setup(e){const V=l({path:[{required:!0,message:"请输入菜单name",trigger:"blur"}],component:[{required:!0,message:"请输入文件路径",trigger:"blur"}],"meta.title":[{required:!0,message:"请输入菜单展示名称",trigger:"blur"}]}),_=a(1),D=a(0),T=a(999),S=a([]),j=a({}),M=async()=>{const e=await c({page:_.value,pageSize:T.value,...j.value});0===e.code&&(S.value=e.data.list,D.value=e.data.total,_.value=e.data.page,T.value=e.data.pageSize)};M();const F=()=>{P.value.component=P.value.component.replace(/\\/g,"/")},P=a({ID:0,path:"",name:"",hidden:!1,parentId:"",component:"",meta:{activeName:"",title:"",icon:"",defaultMenu:!1,closeTab:!1,keepAlive:!1},parameters:[],menuBtn:[]}),W=()=>{P.value.path=P.value.name},$=e=>{K(),e()},E=a(null),H=a(!1),K=()=>{H.value=!1,E.value.resetFields(),P.value={ID:0,path:"",name:"",hidden:!1,parentId:"",component:"",meta:{title:"",icon:"",defaultMenu:!1,closeTab:!1,keepAlive:!1}}},O=a(!1),Q=()=>{K(),O.value=!1},G=async()=>{E.value.validate((async e=>{if(e){let e;e=X.value?await y(P.value):await w(P.value),0===e.code&&(b({type:"success",message:X.value?"编辑成功":"添加成功!"}),M()),K(),O.value=!1}}))},J=a([{ID:"0",title:"根菜单"}]),L=()=>{J.value=[{ID:"0",title:"根目录"}],R(S.value,J.value,!1)},R=(e,l,a)=>{e&&e.forEach((e=>{if(e.children&&e.children.length){const t={title:e.meta.title,ID:String(e.ID),disabled:a||e.ID===P.value.ID,children:[]};R(e.children,t.children,a||e.ID===P.value.ID),l.push(t)}else{const t={title:e.meta.title,ID:String(e.ID),disabled:a||e.ID===P.value.ID};l.push(t)}}))},X=a(!1),Y=a("新增菜单"),Z=e=>{Y.value="新增菜单",P.value.parentId=String(e),X.value=!1,L(),O.value=!0};return(e,l)=>{const a=t("el-button"),c=t("el-table-column"),y=t("el-icon"),w=t("el-table"),D=t("el-input"),T=t("el-form-item"),j=t("el-checkbox"),K=t("el-option"),R=t("el-select"),ee=t("el-cascader"),le=t("QuestionFilled"),ae=t("el-tooltip"),te=t("el-form"),oe=t("el-dialog");return o(),u("div",null,[d("div",U,[d("div",C,[i(a,{size:"small",type:"primary",icon:"plus",onClick:l[0]||(l[0]=e=>Z("0"))},{default:n((()=>[m("新增根菜单")])),_:1})]),i(w,{data:S.value,"row-key":"ID"},{default:n((()=>[i(c,{align:"left",label:"ID","min-width":"100",prop:"ID"}),i(c,{align:"left",label:"展示名称","min-width":"120",prop:"authorityName"},{default:n((e=>[d("span",null,p(e.row.meta.title),1)])),_:1}),i(c,{align:"left",label:"图标","min-width":"140",prop:"authorityName"},{default:n((e=>[e.row.meta.icon?(o(),u("div",z,[i(y,null,{default:n((()=>[(o(),r(s(e.row.meta.icon)))])),_:2},1024),d("span",null,p(e.row.meta.icon),1)])):v("",!0)])),_:1}),i(c,{align:"left",label:"路由Name","show-overflow-tooltip":"","min-width":"160",prop:"name"}),i(c,{align:"left",label:"路由Path","show-overflow-tooltip":"","min-width":"160",prop:"path"}),i(c,{align:"left",label:"是否隐藏","min-width":"100",prop:"hidden"},{default:n((e=>[d("span",null,p(e.row.hidden?"隐藏":"显示"),1)])),_:1}),i(c,{align:"left",label:"父节点","min-width":"90",prop:"parentId"}),i(c,{align:"left",label:"排序","min-width":"70",prop:"sort"}),i(c,{align:"left",label:"文件路径","min-width":"360",prop:"component"}),i(c,{align:"left",fixed:"right",label:"操作",width:"300"},{default:n((e=>[i(a,{size:"small",type:"primary",link:"",icon:"plus",onClick:l=>Z(e.row.ID)},{default:n((()=>[m("添加子菜单")])),_:2},1032,["onClick"]),i(a,{size:"small",type:"primary",link:"",icon:"edit",onClick:l=>(async e=>{Y.value="编辑菜单";const l=await g({id:e});P.value=l.data.menu,X.value=!0,L(),O.value=!0})(e.row.ID)},{default:n((()=>[m("编辑")])),_:2},1032,["onClick"]),i(a,{size:"small",type:"primary",link:"",icon:"delete",onClick:l=>{return a=e.row.ID,void f.confirm("此操作将永久删除所有角色下该菜单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await h({ID:a})).code&&(b({type:"success",message:"删除成功!"}),1===S.value.length&&_.value>1&&_.value--,M())})).catch((()=>{b({type:"info",message:"已取消删除"})}));var a}},{default:n((()=>[m("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),i(oe,{modelValue:O.value,"onUpdate:modelValue":l[15]||(l[15]=e=>O.value=e),"before-close":$,title:Y.value},{footer:n((()=>[d("div",A,[i(a,{size:"small",onClick:Q},{default:n((()=>[m("取 消")])),_:1}),i(a,{size:"small",type:"primary",onClick:G},{default:n((()=>[m("确 定")])),_:1})])])),default:n((()=>[i(I,{title:"新增菜单，需要在角色管理内配置权限才可使用"}),O.value?(o(),r(te,{key:0,ref_key:"menuForm",ref:E,inline:!0,model:P.value,rules:V,"label-position":"top","label-width":"85px"},{default:n((()=>[i(T,{label:"路由Name",prop:"path",style:{width:"30%"}},{default:n((()=>[i(D,{modelValue:P.value.name,"onUpdate:modelValue":l[1]||(l[1]=e=>P.value.name=e),autocomplete:"off",placeholder:"唯一英文字符串",onChange:W},null,8,["modelValue"])])),_:1}),i(T,{prop:"path",style:{width:"30%"}},{label:n((()=>[d("div",B,[m(" 路由Path "),i(j,{modelValue:H.value,"onUpdate:modelValue":l[2]||(l[2]=e=>H.value=e),style:{float:"right","margin-left":"20px"}},{default:n((()=>[m("添加参数")])),_:1},8,["modelValue"])])])),default:n((()=>[i(D,{modelValue:P.value.path,"onUpdate:modelValue":l[3]||(l[3]=e=>P.value.path=e),disabled:!H.value,autocomplete:"off",placeholder:"建议只在后方拼接参数"},null,8,["modelValue","disabled"])])),_:1}),i(T,{label:"是否隐藏",style:{width:"30%"}},{default:n((()=>[i(R,{modelValue:P.value.hidden,"onUpdate:modelValue":l[4]||(l[4]=e=>P.value.hidden=e),placeholder:"是否在列表隐藏"},{default:n((()=>[i(K,{value:!1,label:"否"}),i(K,{value:!0,label:"是"})])),_:1},8,["modelValue"])])),_:1}),i(T,{label:"父节点ID",style:{width:"30%"}},{default:n((()=>[i(ee,{modelValue:P.value.parentId,"onUpdate:modelValue":l[5]||(l[5]=e=>P.value.parentId=e),style:{width:"100%"},disabled:!X.value,options:J.value,props:{checkStrictly:!0,label:"title",value:"ID",disabled:"disabled",emitPath:!1},"show-all-levels":!1,filterable:""},null,8,["modelValue","disabled","options"])])),_:1}),i(T,{label:"文件路径",prop:"component",style:{width:"60%"}},{default:n((()=>[i(D,{modelValue:P.value.component,"onUpdate:modelValue":l[6]||(l[6]=e=>P.value.component=e),autocomplete:"off",placeholder:"页面:view/xxx/xx.vue 插件:plugin/xx/xx.vue",onBlur:F},null,8,["modelValue"]),N,i(a,{style:{"margin-top":"4px"},size:"small",onClick:l[7]||(l[7]=e=>P.value.component="view/routerHolder.vue")},{default:n((()=>[m("点我设置")])),_:1})])),_:1}),i(T,{label:"展示名称",prop:"meta.title",style:{width:"30%"}},{default:n((()=>[i(D,{modelValue:P.value.meta.title,"onUpdate:modelValue":l[8]||(l[8]=e=>P.value.meta.title=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),i(T,{label:"图标",prop:"meta.icon",style:{width:"30%"}},{default:n((()=>[i(k,{meta:P.value.meta,style:{width:"100%"}},null,8,["meta"])])),_:1}),i(T,{label:"排序标记",prop:"sort",style:{width:"30%"}},{default:n((()=>[i(D,{modelValue:P.value.sort,"onUpdate:modelValue":l[9]||(l[9]=e=>P.value.sort=e),modelModifiers:{number:!0},autocomplete:"off"},null,8,["modelValue"])])),_:1}),i(T,{prop:"meta.activeName",style:{width:"30%"}},{label:n((()=>[d("div",null,[q,i(ae,{content:"注：当到达此路由时候，指定左侧菜单指定name会处于活跃状态（亮起），可为空，为空则为本路由Name。",placement:"bottom",effect:"light"},{default:n((()=>[i(y,null,{default:n((()=>[i(le)])),_:1})])),_:1})])])),default:n((()=>[i(D,{modelValue:P.value.meta.activeName,"onUpdate:modelValue":l[10]||(l[10]=e=>P.value.meta.activeName=e),placeholder:P.value.name,autocomplete:"off"},null,8,["modelValue","placeholder"])])),_:1}),i(T,{label:"KeepAlive",prop:"meta.keepAlive",style:{width:"30%"}},{default:n((()=>[i(R,{modelValue:P.value.meta.keepAlive,"onUpdate:modelValue":l[11]||(l[11]=e=>P.value.meta.keepAlive=e),style:{width:"100%"},placeholder:"是否keepAlive缓存页面"},{default:n((()=>[i(K,{value:!1,label:"否"}),i(K,{value:!0,label:"是"})])),_:1},8,["modelValue"])])),_:1}),i(T,{label:"CloseTab",prop:"meta.closeTab",style:{width:"30%"}},{default:n((()=>[i(R,{modelValue:P.value.meta.closeTab,"onUpdate:modelValue":l[12]||(l[12]=e=>P.value.meta.closeTab=e),style:{width:"100%"},placeholder:"是否自动关闭tab"},{default:n((()=>[i(K,{value:!1,label:"否"}),i(K,{value:!0,label:"是"})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])):v("",!0),d("div",null,[i(a,{size:"small",type:"primary",icon:"edit",onClick:l[13]||(l[13]=e=>{return(l=P.value).parameters||(l.parameters=[]),void l.parameters.push({type:"query",key:"",value:""});var l})},{default:n((()=>[m("新增菜单参数")])),_:1}),i(w,{data:P.value.parameters,style:{width:"100%"}},{default:n((()=>[i(c,{align:"left",prop:"type",label:"参数类型",width:"180"},{default:n((e=>[i(R,{modelValue:e.row.type,"onUpdate:modelValue":l=>e.row.type=l,placeholder:"请选择"},{default:n((()=>[i(K,{key:"query",value:"query",label:"query"}),i(K,{key:"params",value:"params",label:"params"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),i(c,{align:"left",prop:"key",label:"参数key",width:"180"},{default:n((e=>[d("div",null,[i(D,{modelValue:e.row.key,"onUpdate:modelValue":l=>e.row.key=l},null,8,["modelValue","onUpdate:modelValue"])])])),_:1}),i(c,{align:"left",prop:"value",label:"参数值"},{default:n((e=>[d("div",null,[i(D,{modelValue:e.row.value,"onUpdate:modelValue":l=>e.row.value=l},null,8,["modelValue","onUpdate:modelValue"])])])),_:1}),i(c,{align:"left"},{default:n((e=>[d("div",null,[i(a,{type:"danger",size:"small",icon:"delete",onClick:l=>{return a=P.value.parameters,t=e.$index,void a.splice(t,1);var a,t}},{default:n((()=>[m("删除")])),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"]),i(a,{style:{"margin-top":"12px"},size:"small",type:"primary",icon:"edit",onClick:l[14]||(l[14]=e=>{return(l=P.value).menuBtn||(l.menuBtn=[]),void l.menuBtn.push({name:"",desc:""});var l})},{default:n((()=>[m("新增可控按钮")])),_:1}),i(w,{data:P.value.menuBtn,style:{width:"100%"}},{default:n((()=>[i(c,{align:"left",prop:"name",label:"按钮名称",width:"180"},{default:n((e=>[d("div",null,[i(D,{modelValue:e.row.name,"onUpdate:modelValue":l=>e.row.name=l},null,8,["modelValue","onUpdate:modelValue"])])])),_:1}),i(c,{align:"left",prop:"name",label:"备注",width:"180"},{default:n((e=>[d("div",null,[i(D,{modelValue:e.row.desc,"onUpdate:modelValue":l=>e.row.desc=l},null,8,["modelValue","onUpdate:modelValue"])])])),_:1}),i(c,{align:"left"},{default:n((e=>[d("div",null,[i(a,{type:"danger",size:"small",icon:"delete",onClick:l=>(async(e,l)=>{const a=e[l];if(0===a.ID)return void e.splice(l,1);0!==(await x({id:a.ID})).code||e.splice(l,1)})(P.value.menuBtn,e.$index)},{default:n((()=>[m("删除")])),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"])])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-63bcc824"]]);export{S as default};
